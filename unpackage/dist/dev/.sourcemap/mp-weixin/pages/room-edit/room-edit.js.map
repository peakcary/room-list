{"version":3,"file":"room-edit.js","sources":["pages/room-edit/room-edit.vue","pages/room-edit/room-edit.vue?type=page"],"sourcesContent":["<template>\r\n  <view class=\"container\">\r\n    <form @submit=\"saveRoom\">\r\n      <!-- 基本信息 -->\r\n      <view class=\"form-section\">\r\n        <view class=\"section-title\">基本信息</view>\r\n        \r\n        <view class=\"form-item\">\r\n          <view class=\"form-label\">房间号 *</view>\r\n          <input \r\n            class=\"form-input\"\r\n            v-model=\"formData.room_number\"\r\n            placeholder=\"请输入房间号\"\r\n          />\r\n        </view>\r\n        \r\n        <view class=\"form-item\">\r\n          <view class=\"form-label\">楼层</view>\r\n          <input \r\n            class=\"form-input\"\r\n            v-model.number=\"formData.floor\"\r\n            type=\"number\"\r\n            placeholder=\"请输入楼层\"\r\n          />\r\n        </view>\r\n      </view>\r\n\r\n\r\n      <!-- 操作按钮 -->\r\n      <view class=\"form-actions\">\r\n        <button class=\"btn-cancel\" @click=\"cancel\">取消</button>\r\n        <button class=\"btn-save\" @click=\"saveRoom\">保存</button>\r\n      </view>\r\n    </form>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      formData: {\r\n        room_number: '',\r\n        floor: ''\r\n      }\r\n    }\r\n  },\r\n  \r\n  onLoad(options) {\r\n    // 检查登录状态\r\n    this.checkAuth();\r\n    \r\n    uni.setNavigationBarTitle({\r\n      title: '添加房间'\r\n    });\r\n  },\r\n  \r\n  methods: {\r\n    // 检查认证状态\r\n    checkAuth() {\r\n      const { checkPageAuth } = require('../../utils/auth.js');\r\n      return checkPageAuth();\r\n    },\r\n    \r\n    // 表单验证\r\n    validateForm() {\r\n      if (!this.formData.room_number.trim()) {\r\n        uni.showToast({\r\n          title: '请输入房间号',\r\n          icon: 'none'\r\n        });\r\n        return false;\r\n      }\r\n      \r\n      return true;\r\n    },\r\n    \r\n    // 保存房间\r\n    async saveRoom() {\r\n      if (!this.validateForm()) return;\r\n      \r\n      uni.showLoading({\r\n        title: '添加中...'\r\n      });\r\n      \r\n      try {\r\n        const roomData = {\r\n          ...this.formData,\r\n          status: 'available' // 新房间默认为可租用状态\r\n        };\r\n        \r\n        const result = await uniCloud.callFunction({\r\n          name: 'room-management',\r\n          data: {\r\n            action: 'addRoom',\r\n            data: roomData\r\n          }\r\n        });\r\n        \r\n        if (result.result.code === 0) {\r\n          uni.showToast({\r\n            title: '添加成功',\r\n            icon: 'success'\r\n          });\r\n          \r\n          setTimeout(() => {\r\n            uni.navigateBack();\r\n          }, 1500);\r\n        } else {\r\n          uni.showToast({\r\n            title: result.result.message,\r\n            icon: 'none'\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error('添加房间失败:', error);\r\n        uni.showToast({\r\n          title: '添加失败',\r\n          icon: 'none'\r\n        });\r\n      } finally {\r\n        uni.hideLoading();\r\n      }\r\n    },\r\n    \r\n    // 取消\r\n    cancel() {\r\n      uni.navigateBack();\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.container {\r\n  background-color: #f5f5f5;\r\n  min-height: 100vh;\r\n  padding: 20rpx;\r\n}\r\n\r\n.form-section {\r\n  background-color: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 40rpx;\r\n  margin-bottom: 20rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(0,0,0,0.05);\r\n}\r\n\r\n.section-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.form-item {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.form-item:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.form-label {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.form-input {\r\n  width: 100%;\r\n  padding: 20rpx;\r\n  border: 2rpx solid #e8e8e8;\r\n  border-radius: 8rpx;\r\n  font-size: 28rpx;\r\n  background-color: #fff;\r\n}\r\n\r\n.form-input:focus {\r\n  border-color: #007AFF;\r\n}\r\n\r\n.form-input[disabled] {\r\n  background-color: #f5f5f5;\r\n  color: #999;\r\n}\r\n\r\n.picker-input {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 20rpx;\r\n  border: 2rpx solid #e8e8e8;\r\n  border-radius: 8rpx;\r\n  font-size: 28rpx;\r\n  background-color: #fff;\r\n}\r\n\r\n.arrow {\r\n  color: #999;\r\n  font-size: 24rpx;\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  gap: 20rpx;\r\n  padding: 40rpx 20rpx;\r\n}\r\n\r\n.btn-cancel, .btn-save {\r\n  flex: 1;\r\n  padding: 28rpx;\r\n  border: none;\r\n  border-radius: 12rpx;\r\n  font-size: 32rpx;\r\n}\r\n\r\n.btn-cancel {\r\n  background-color: #f5f5f5;\r\n  color: #666;\r\n}\r\n\r\n.btn-save {\r\n  background-color: #007AFF;\r\n  color: white;\r\n}\r\n</style>","import MiniProgramPage from '/Users/peakom/Documents/room-list/pages/room-edit/room-edit.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;AAsCA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,UAAU;AAAA,QACR,aAAa;AAAA,QACb,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACD;AAAA,EAED,OAAO,SAAS;AAEd,SAAK,UAAS;AAEdA,kBAAAA,MAAI,sBAAsB;AAAA,MACxB,OAAO;AAAA,IACT,CAAC;AAAA,EACF;AAAA,EAED,SAAS;AAAA;AAAA,IAEP,YAAY;AACV,YAAM,EAAE,kBAAkB,QAAQ,qBAAqB;AACvD,aAAO,cAAa;AAAA,IACrB;AAAA;AAAA,IAGD,eAAe;AACb,UAAI,CAAC,KAAK,SAAS,YAAY,KAAI,GAAI;AACrCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACR,CAAC;AACD,eAAO;AAAA,MACT;AAEA,aAAO;AAAA,IACR;AAAA;AAAA,IAGD,MAAM,WAAW;AACf,UAAI,CAAC,KAAK,aAAY;AAAI;AAE1BA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,MACT,CAAC;AAED,UAAI;AACF,cAAM,WAAW;AAAA,UACf,GAAG,KAAK;AAAA,UACR,QAAQ;AAAA;AAAA;AAGV,cAAM,SAAS,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACzC,MAAM;AAAA,UACN,MAAM;AAAA,YACJ,QAAQ;AAAA,YACR,MAAM;AAAA,UACR;AAAA,QACF,CAAC;AAED,YAAI,OAAO,OAAO,SAAS,GAAG;AAC5BD,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACR,CAAC;AAED,qBAAW,MAAM;AACfA,0BAAG,MAAC,aAAY;AAAA,UACjB,GAAE,IAAI;AAAA,eACF;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO,OAAO,OAAO;AAAA,YACrB,MAAM;AAAA,UACR,CAAC;AAAA,QACH;AAAA,MACA,SAAO,OAAO;AACdA,sBAAc,MAAA,MAAA,SAAA,wCAAA,WAAW,KAAK;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACR,CAAC;AAAA,MACH,UAAU;AACRA,sBAAG,MAAC,YAAW;AAAA,MACjB;AAAA,IACD;AAAA;AAAA,IAGD,SAAS;AACPA,oBAAG,MAAC,aAAY;AAAA,IAClB;AAAA,EACF;AACF;;;;;;;;;;;;;;;ACjIA,GAAG,WAAW,eAAe;"}