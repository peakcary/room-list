# æˆ¿é—´ç®¡ç†ç³»ç»Ÿ - äº‘å‡½æ•°éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### 1. å¼€å‘ç¯å¢ƒè¦æ±‚
- âœ… HBuilderX 3.8+ 
- âœ… uni-app CLI
- âœ… å·²æ³¨å†Œ DCloud å¼€å‘è€…è´¦å·
- âœ… é˜¿é‡Œäº‘ uniCloud æœåŠ¡ç©ºé—´

### 2. é¡¹ç›®ç»“æ„ç¡®è®¤
```
uniCloud-aliyun/
â”œâ”€â”€ cloudfunctions/           # äº‘å‡½æ•°ç›®å½•
â”‚   â”œâ”€â”€ room-management/      # ä¸»è¦ä¸šåŠ¡äº‘å‡½æ•°
â”‚   â””â”€â”€ db-init/             # æ•°æ®åº“åˆå§‹åŒ–å‡½æ•°
â”œâ”€â”€ database/                # æ•°æ®åº“ç»“æ„å®šä¹‰
â”‚   â”œâ”€â”€ rooms.schema.json
â”‚   â”œâ”€â”€ tenants.schema.json
â”‚   â”œâ”€â”€ rentals.schema.json
â”‚   â”œâ”€â”€ utility_records.schema.json
â”‚   â””â”€â”€ maintenance_records.schema.json
â””â”€â”€ spaces.json             # æœåŠ¡ç©ºé—´é…ç½®
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1: ç¡®è®¤æœåŠ¡ç©ºé—´ç»‘å®š
1. æ£€æŸ¥ `uniCloud-aliyun/spaces.json` é…ç½®
2. ç¡®è®¤æœåŠ¡ç©ºé—´IDï¼š`mp-82beb92d-779d-44d1-a1d3-7fee8609024d`
3. æœåŠ¡ç©ºé—´åç§°ï¼š`pang-0217`

### æ­¥éª¤2: éƒ¨ç½²äº‘å‡½æ•°

#### 2.1 åœ¨HBuilderXä¸­éƒ¨ç½²
1. å³é”®ç‚¹å‡» `uniCloud-aliyun/cloudfunctions/room-management`
2. é€‰æ‹©"ä¸Šä¼ å¹¶éƒ¨ç½²"
3. ç­‰å¾…éƒ¨ç½²å®Œæˆ

#### 2.2 éƒ¨ç½²æ•°æ®åº“åˆå§‹åŒ–å‡½æ•°
1. å³é”®ç‚¹å‡» `uniCloud-aliyun/cloudfunctions/db-init`
2. é€‰æ‹©"ä¸Šä¼ å¹¶éƒ¨ç½²"
3. ç­‰å¾…éƒ¨ç½²å®Œæˆ

### æ­¥éª¤3: ä¸Šä¼ æ•°æ®åº“è¡¨ç»“æ„
1. å³é”®ç‚¹å‡» `uniCloud-aliyun/database`
2. é€‰æ‹©"ä¸Šä¼ æ‰€æœ‰DB Schema"
3. ç¡®è®¤æ‰€æœ‰è¡¨ç»“æ„ä¸Šä¼ å®Œæˆ

### æ­¥éª¤4: åˆå§‹åŒ–æ•°æ®åº“
1. åœ¨HBuilderXä¸­æ‰“å¼€äº‘å‡½æ•°è°ƒè¯•
2. è°ƒç”¨ `db-init` å‡½æ•°
3. æˆ–åœ¨å°ç¨‹åºä¸­è®¿é—®ç³»ç»Ÿæµ‹è¯•é¡µé¢

## ğŸ”§ äº‘å‡½æ•°åŠŸèƒ½è¯´æ˜

### room-management ä¸»å‡½æ•°
æ”¯æŒä»¥ä¸‹æ“ä½œï¼š

#### æˆ¿é—´ç®¡ç†
- `getRooms` - è·å–æˆ¿é—´åˆ—è¡¨
- `getRoomById` - è·å–æˆ¿é—´è¯¦æƒ…
- `addRoom` - æ·»åŠ æˆ¿é—´
- `updateRoom` - æ›´æ–°æˆ¿é—´ä¿¡æ¯
- `deleteRoom` - åˆ é™¤æˆ¿é—´

#### ç§Ÿæˆ·ç®¡ç†
- `getTenants` - è·å–ç§Ÿæˆ·åˆ—è¡¨
- `addTenant` - æ·»åŠ ç§Ÿæˆ·
- `updateTenant` - æ›´æ–°ç§Ÿæˆ·ä¿¡æ¯
- `deleteTenant` - åˆ é™¤ç§Ÿæˆ·

#### ç§Ÿèµç®¡ç†
- `createRental` - åˆ›å»ºç§Ÿèµå…³ç³»
- `getRentals` - è·å–ç§Ÿèµåˆ—è¡¨
- `terminateRental` - ç»ˆæ­¢ç§Ÿèµ
- `renewRental` - ç»­ç§Ÿ
- `getRentalHistory` - è·å–ç§Ÿèµå†å²

#### æ°´ç”µè´¹ç®¡ç†
- `addMonthlyUtilityRecord` - æ·»åŠ æ°´ç”µè®°å½•
- `getUtilityRecords` - è·å–æ°´ç”µè®°å½•
- `updateUtilityPayment` - æ›´æ–°ç¼´è´¹çŠ¶æ€

#### ç»´ä¿®ç®¡ç†
- `addMaintenanceRecord` - æ·»åŠ ç»´ä¿®è®°å½•
- `getMaintenanceRecords` - è·å–ç»´ä¿®è®°å½•
- `updateMaintenanceRecord` - æ›´æ–°ç»´ä¿®è®°å½•

#### ç»Ÿè®¡åŠŸèƒ½
- `getIncomeStatistics` - æ”¶å…¥ç»Ÿè®¡
- `getRoomOccupancyStatistics` - æˆ¿é—´å…¥ä½ç»Ÿè®¡
- `getIncomeTrend` - æ”¶å…¥è¶‹åŠ¿
- `getDashboardStatistics` - ä»ªè¡¨æ¿ç»Ÿè®¡

### db-init åˆå§‹åŒ–å‡½æ•°
- åˆ›å»ºç¤ºä¾‹æ•°æ®
- åˆå§‹åŒ–æ•°æ®åº“ç»“æ„
- æ”¯æŒå¼ºåˆ¶é‡ç½®ï¼ˆ`forceReset: true`ï¼‰

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### rooms (æˆ¿é—´è¡¨)
- room_number: æˆ¿é—´å·
- floor: æ¥¼å±‚
- status: çŠ¶æ€ (available/rented/maintenance)
- current_rental_id: å½“å‰ç§ŸèµID

### tenants (ç§Ÿæˆ·è¡¨)
- name: å§“å
- id_card: èº«ä»½è¯å·
- phone: ç”µè¯
- emergency_contact: ç´§æ€¥è”ç³»äºº

### rentals (ç§Ÿèµè¡¨)
- room_id: æˆ¿é—´ID
- tenant_id: ç§Ÿæˆ·ID
- rent_price: ç§Ÿé‡‘
- deposit: æŠ¼é‡‘
- rent_start_date: å¼€å§‹æ—¥æœŸ
- rent_end_date: ç»“æŸæ—¥æœŸ
- status: çŠ¶æ€ (active/terminated/expired)

### utility_records (æ°´ç”µè®°å½•è¡¨)
- room_id: æˆ¿é—´ID
- record_date: è®°å½•æ—¥æœŸ
- electricity_reading: ç”µè¡¨è¯»æ•°
- water_reading: æ°´è¡¨è¯»æ•°
- total_fee: æ€»è´¹ç”¨
- is_paid: æ˜¯å¦å·²ç¼´è´¹

### maintenance_records (ç»´ä¿®è®°å½•è¡¨)
- room_id: æˆ¿é—´ID
- description: ç»´ä¿®æè¿°
- amount: è´¹ç”¨
- status: çŠ¶æ€

## ğŸ” éƒ¨ç½²éªŒè¯

### 1. äº‘å‡½æ•°æµ‹è¯•
åœ¨HBuilderXäº‘å‡½æ•°è°ƒè¯•ä¸­æµ‹è¯•ï¼š
```javascript
// æµ‹è¯•è·å–æˆ¿é—´åˆ—è¡¨
{
  "action": "getRooms",
  "data": {
    "pageSize": 10,
    "pageNum": 1
  }
}
```

### 2. å°ç¨‹åºæµ‹è¯•
1. å¯åŠ¨å°ç¨‹åº
2. ç™»å½•ç³»ç»Ÿï¼ˆadmin/123456 æˆ– manager/888888ï¼‰
3. æ£€æŸ¥æˆ¿é—´åˆ—è¡¨æ˜¯å¦æ˜¾ç¤º
4. æµ‹è¯•å„é¡¹åŠŸèƒ½

## ğŸš¨ å¸¸è§é—®é¢˜

### é—®é¢˜1: äº‘å‡½æ•°è°ƒç”¨å¤±è´¥
**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥æœåŠ¡ç©ºé—´ç»‘å®š
2. ç¡®è®¤äº‘å‡½æ•°å·²æ­£ç¡®éƒ¨ç½²
3. æ£€æŸ¥ç½‘ç»œæƒé™é…ç½®

### é—®é¢˜2: æ•°æ®ä¸æ˜¾ç¤º
**è§£å†³æ–¹æ¡ˆ:**
1. è¿è¡Œæ•°æ®åº“åˆå§‹åŒ–
2. æ£€æŸ¥æ•°æ®åº“è¡¨ç»“æ„
3. éªŒè¯äº‘å‡½æ•°æƒé™

### é—®é¢˜3: å°ç¨‹åºä½“éªŒç‰ˆæ— æ³•è®¿é—®
**è§£å†³æ–¹æ¡ˆ:**
1. ç¡®è®¤åœ¨ https://dev.dcloud.net.cn/ åˆ›å»ºäº†åº”ç”¨
2. æ£€æŸ¥æœåŠ¡ç©ºé—´å…³è”
3. æ·»åŠ åŸŸåç™½åå•

## ğŸ“± åŸŸåç™½åå•é…ç½®

åœ¨å¾®ä¿¡å°ç¨‹åºåå°æ·»åŠ ä»¥ä¸‹åŸŸåï¼š
- `https://api.next.bspapp.com`
- å…¶ä»–uniCloudç›¸å…³åŸŸå

## ğŸ” å®‰å…¨é…ç½®

1. **æ•°æ®åº“æƒé™**: å½“å‰ä¸ºå¼€å‘æ¨¡å¼ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦é…ç½®å®‰å…¨è§„åˆ™
2. **äº‘å‡½æ•°æƒé™**: å»ºè®®æ·»åŠ ç”¨æˆ·èº«ä»½éªŒè¯
3. **APIå®‰å…¨**: å»ºè®®æ·»åŠ è¯·æ±‚ç­¾åéªŒè¯

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç´¢å¼•ä¼˜åŒ–**: ä¸ºç»å¸¸æŸ¥è¯¢çš„å­—æ®µæ·»åŠ æ•°æ®åº“ç´¢å¼•
2. **ç¼“å­˜ç­–ç•¥**: ä½¿ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
3. **åˆ†é¡µæŸ¥è¯¢**: å¤§æ•°æ®é‡æŸ¥è¯¢ä½¿ç”¨åˆ†é¡µ
4. **CDNåŠ é€Ÿ**: é™æ€èµ„æºä½¿ç”¨CDN

## ğŸ”„ ç»´æŠ¤å’Œæ›´æ–°

### æ—¥å¸¸ç»´æŠ¤
1. å®šæœŸå¤‡ä»½æ•°æ®åº“
2. ç›‘æ§äº‘å‡½æ•°æ‰§è¡Œæƒ…å†µ
3. æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—

### ç‰ˆæœ¬æ›´æ–°
1. æµ‹è¯•ç¯å¢ƒéªŒè¯
2. ç°åº¦å‘å¸ƒ
3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

---

**éƒ¨ç½²æ”¯æŒ**: å¦‚æœ‰é—®é¢˜è¯·æŸ¥çœ‹HBuilderXæ–‡æ¡£æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ