{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<template>\r\n  <view class=\"app\">\r\n    <!-- 主内容区域 -->\r\n    <view class=\"main-content\">\r\n      <!-- 这里是页面内容 -->\r\n    </view>\r\n    \r\n    <!-- 自定义 tabbar (仅在 H5 端显示) -->\r\n    <!-- #ifdef H5 -->\r\n    <custom-tabbar></custom-tabbar>\r\n    <!-- #endif -->\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n// #ifdef H5\r\nimport CustomTabbar from '@/components/custom-tabbar/custom-tabbar.vue'\r\n// #endif\r\n\r\nexport default {\r\n  // #ifdef H5\r\n  components: {\r\n    CustomTabbar\r\n  },\r\n  // #endif\r\n  \r\n  onLaunch: function() {\r\n    console.log('App Launch')\r\n    // 初始化应用时检查登录状态\r\n    this.checkInitialAuth()\r\n  },\r\n  onShow: function() {\r\n    console.log('App Show')\r\n  },\r\n  onHide: function() {\r\n    console.log('App Hide')  \r\n  },\r\n  \r\n  methods: {\r\n    // 检查应用启动时的认证状态\r\n    checkInitialAuth() {\r\n      try {\r\n        const { isLoggedIn } = require('./utils/auth.js')\r\n        \r\n        // 获取当前页面\r\n        const pages = getCurrentPages()\r\n        const currentPage = pages.length > 0 ? pages[pages.length - 1] : null\r\n        const currentRoute = currentPage ? `/${currentPage.route}` : ''\r\n        \r\n        console.log('App启动检查认证状态, 当前路由:', currentRoute)\r\n        \r\n        // 如果当前不在登录页面且未登录，则跳转到登录页面\r\n        if (currentRoute !== '/pages/login/login' && !isLoggedIn()) {\r\n          console.log('未登录，跳转到登录页面')\r\n          setTimeout(() => {\r\n            uni.reLaunch({\r\n              url: '/pages/login/login'\r\n            })\r\n          }, 100)\r\n        }\r\n      } catch (error) {\r\n        console.error('检查认证状态失败:', error)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n/* 全局样式 */\r\n.app {\r\n  height: 100vh;\r\n}\r\n\r\n.main-content {\r\n  height: 100%;\r\n  /* #ifdef H5 */\r\n  padding-bottom: 50px; /* 为自定义tabbar留出空间 */\r\n  /* #endif */\r\n}\r\n\r\n/* 全局CSS变量 */\r\npage {\r\n  --primary-color: #007AFF;\r\n  --text-color: #333;\r\n  --border-color: #e5e5e5;\r\n  --bg-color: #f5f5f5;\r\n}\r\n\r\n/* 通用样式 */\r\n.container {\r\n  background-color: var(--bg-color);\r\n  min-height: 100vh;\r\n}\r\n\r\n/* 按钮通用样式 */\r\n.btn {\r\n  border-radius: 8rpx;\r\n  border: none;\r\n  font-size: 28rpx;\r\n  padding: 20rpx 40rpx;\r\n}\r\n\r\n.btn-primary {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n}\r\n\r\n.btn-secondary {\r\n  background-color: #f5f5f5;\r\n  color: #666;\r\n}\r\n\r\n/* 表单通用样式 */\r\n.form-item {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.form-label {\r\n  font-size: 28rpx;\r\n  color: var(--text-color);\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.form-input {\r\n  width: 100%;\r\n  padding: 20rpx;\r\n  border: 2rpx solid var(--border-color);\r\n  border-radius: 8rpx;\r\n  font-size: 28rpx;\r\n  background-color: #fff;\r\n}\r\n\r\n.form-input:focus {\r\n  border-color: var(--primary-color);\r\n}\r\n</style>\r\n","import App from './App'\n\n// 微信小程序uniCloud初始化 - 解决体验版问题\n// #ifdef MP-WEIXIN\nimport { initUniCloud } from './utils/cloud-init.js'\n\n// 延迟初始化确保小程序环境完全加载\nsetTimeout(() => {\n  initUniCloud()\n    .then((success) => {\n      console.log('[App] uniCloud初始化完成:', success ? '成功' : '部分成功')\n    })\n    .catch((error) => {\n      console.error('[App] uniCloud初始化失败:', error.message)\n    })\n}, 100)\n// #endif\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\nconst app = new Vue({\n  ...App\n})\napp.$mount()\n// #endif\n\n// #ifdef VUE3\nimport { createSSRApp } from 'vue'\nexport function createApp() {\n  const app = createSSRApp(App)\n  return {\n    app\n  }\n}\n// #endif"],"names":["uni","initUniCloud","createSSRApp"],"mappings":";;;;;;;;;;;;;;;;;;AAmBA,MAAK,YAAU;AAAA,EAOb,UAAU,WAAW;AACnBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,YAAY;AAExB,SAAK,iBAAiB;AAAA,EACvB;AAAA,EACD,QAAQ,WAAW;AACjBA,kBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,EACvB;AAAA,EACD,QAAQ,WAAW;AACjBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAAA,EACvB;AAAA,EAED,SAAS;AAAA;AAAA,IAEP,mBAAmB;AACjB,UAAI;AACF,cAAM,EAAE,eAAe,QAAQ,iBAAiB;AAGhD,cAAM,QAAQ,gBAAgB;AAC9B,cAAM,cAAc,MAAM,SAAS,IAAI,MAAM,MAAM,SAAS,CAAC,IAAI;AACjE,cAAM,eAAe,cAAc,IAAI,YAAY,KAAK,KAAK;AAE7DA,sBAAAA,MAAY,MAAA,OAAA,iBAAA,sBAAsB,YAAY;AAG9C,YAAI,iBAAiB,wBAAwB,CAAC,cAAc;AAC1DA,wBAAAA,MAAA,MAAA,OAAA,iBAAY,aAAa;AACzB,qBAAW,MAAM;AACfA,0BAAAA,MAAI,SAAS;AAAA,cACX,KAAK;AAAA,aACN;AAAA,UACF,GAAE,GAAG;AAAA,QACR;AAAA,MACA,SAAO,OAAO;AACdA,sBAAAA,MAAc,MAAA,SAAA,iBAAA,aAAa,KAAK;AAAA,MAClC;AAAA,IACF;AAAA,EACF;AACF;;;;;AC1DA,WAAW,MAAM;AACfC,+BAAc,EACX,KAAK,CAAC,YAAY;AACjBD,sDAAY,wBAAwB,UAAU,OAAO,MAAM;AAAA,EACjE,CAAK,EACA,MAAM,CAAC,UAAU;AAChBA,kBAAA,MAAA,MAAA,SAAA,iBAAc,wBAAwB,MAAM,OAAO;AAAA,EACzD,CAAK;AACL,GAAG,GAAG;AAgBC,SAAS,YAAY;AAC1B,QAAM,MAAME,cAAY,aAAC,GAAG;AAC5B,SAAO;AAAA,IACL;AAAA,EACD;AACH;;;"}